<!DOCTYPE html>
<html lang="id" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KALENDER 2026 M / 1447/8 H</title>
    <script src="/_sdk/element_sdk.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        box-sizing: border-box;
      }

      @keyframes gradientFlow {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      .animated-bg {
        background: linear-gradient(
          -45deg,
          #3b82f6,
          #10b981,
          #fbbf24,
          #06b6d4,
          #8b5cf6
        );
        background-size: 400% 400%;
        animation: gradientFlow 15s ease infinite;
      }

      .day-cell {
        transition: all 0.2s ease;
      }

      .day-cell:hover {
        transform: scale(1.05);
      }

      .sunday {
        color: #ef4444;
      }

      .month-card {
        transition: all 0.3s ease;
        transform-style: preserve-3d;
        perspective: 1000px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15),
          0 5px 15px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }

      .month-card:hover {
        transform: translateY(-10px) rotateX(2deg) rotateY(2deg);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2),
          0 10px 20px rgba(0, 0, 0, 0.15),
          inset 0 1px 0 rgba(255, 255, 255, 0.6);
      }

      .card-inner {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95) 0%,
          rgba(255, 255, 255, 0.85) 100%
        );
        backdrop-filter: blur(10px);
        border-radius: 0.5rem;
      }

      .hijri-indicator {
        position: absolute;
        bottom: 2px;
        right: 2px;
        width: 6px;
        height: 6px;
        background-color: #10b981;
        border-radius: 50%;
        box-shadow: 0 0 4px rgba(16, 185, 129, 0.6);
      }

      .hijri-tooltip {
        position: fixed;
        background-color: rgba(16, 185, 129, 0.95);
        color: white;
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 12px;
        z-index: 1000;
        pointer-events: none;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        white-space: nowrap;
        display: none;
      }
    </style>
    <style>
      @view-transition {
        navigation: auto;
      }
    </style>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  </head>
  <body class="h-full">
    <div
      id="app"
      class="w-full h-full overflow-auto animated-bg p-4 sm:p-6 lg:p-8"
    >
      <div class="max-w-7xl mx-auto">
        <header class="text-center mb-8">
          <h1
            id="calendar-title"
            class="text-4xl sm:text-5xl lg:text-6xl font-bold text-indigo-900 mb-2"
          >
            KALENDER 2026 M / 1447/8 H
          </h1>
          <p id="year-text" class="text-xl sm:text-2xl text-indigo-700">
            Do The Best and Be The Best Dengan Bismillah
          </p>
        </header>
        <div
          id="calendar-grid"
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
        >
          <!-- Calendar months will be rendered here -->
        </div>
      </div>
    </div>
    <div id="hijri-tooltip" class="hijri-tooltip"></div>
    <script>
      const defaultConfig = {
        calendar_title: "Kalender 2026",
        year_text: "2026",
        background_color: "#eff6ff",
        card_color: "#ffffff",
        text_color: "#312e81",
        header_color: "#4f46e5",
        accent_color: "#8b5cf6",
        font_family: "system-ui",
        font_size: 16,
      };

      const monthNames = [
        "Januari",
        "Februari",
        "Maret",
        "April",
        "Mei",
        "Juni",
        "Juli",
        "Agustus",
        "September",
        "Oktober",
        "November",
        "Desember",
      ];

      const dayNames = ["Min", "Sen", "Sel", "Rab", "Kam", "Jum", "Sab"];

      // Hari Libur Nasional
      const holidays = {
        0: {
          // Januari
          1: { type: "libur", text: "Tahun Baru 2026 Masehi" },
          16: { type: "libur", text: "Isra Mikraj Nabi Muhammad S.A.W." },
        },
        1: {
          // Februari
          16: { type: "cuti", text: "Cuti Bersama Tahun Baru Imlek" },
          17: { type: "libur", text: "Tahun Baru Imlek 2577 Kongzili" },
        },
        2: {
          // Maret
          18: { type: "cuti", text: "Cuti Bersama Hari Suci Nyepi" },
          19: { type: "libur", text: "Hari Suci Nyepi Tahun Baru Saka 1948" },
          20: { type: "cuti", text: "Cuti Bersama Idul Fitri" },
          21: { type: "libur", text: "Idul Fitri 1447 Hijriah" },
          22: { type: "libur", text: "Idul Fitri 1447 Hijriah" },
          23: { type: "cuti", text: "Cuti Bersama Idul Fitri" },
          24: { type: "cuti", text: "Cuti Bersama Idul Fitri" },
        },
        3: {
          // April
          3: { type: "libur", text: "Wafat Yesus Kristus" },
          5: { type: "libur", text: "Kebangkitan Yesus Kristus (Paskah)" },
        },
        4: {
          // Mei
          1: { type: "libur", text: "Hari Buruh Internasional" },
          14: { type: "libur", text: "Kenaikan Yesus Kristus" },
          15: { type: "cuti", text: "Cuti Bersama Kenaikan Yesus Kristus" },
          27: { type: "libur", text: "Idul Adha 1447 Hijriah" },
          28: { type: "cuti", text: "Cuti Bersama Idul Adha" },
          31: { type: "libur", text: "Hari Raya Waisak 2570 BE" },
        },
        5: {
          // Juni
          1: { type: "libur", text: "Hari Lahir Pancasila" },
          16: {
            type: "libur",
            text: "1 Muharam Tahun Baru Islam 1448 Hijriah",
          },
        },
        7: {
          // Agustus
          17: { type: "libur", text: "Proklamasi Kemerdekaan" },
          25: { type: "libur", text: "Maulid Nabi Muhammad S.A.W." },
        },
        11: {
          // Desember
          24: { type: "cuti", text: "Cuti Bersama Kelahiran Yesus Kristus" },
          25: { type: "libur", text: "Kelahiran Yesus Kristus" },
        },
      };

      // Tanggal Hijriah
      const hijriDates = {
        0: {
          // Januari
          2: { type: "hijri", text: "Rajab 1447 H" },
          3: { type: "hijri", text: "Rajab 1447 H" },
          4: { type: "hijri", text: "Rajab 1447 H" },
        },
        1: {
          // Februari
          1: { type: "hijri", text: "Sha'ban 1447 H" },
          2: { type: "hijri", text: "Sha'ban 1447 H" },
          3: { type: "hijri", text: "Sha'ban 1447 H" },
        },
        /* 2: {
          // Maret
          2: { type: "hijri", text: "Ramadan 1447 H" },
          3: { type: "hijri", text: "Ramadan 1447 H" },
          4: { type: "hijri", text: "Ramadan 1447 H" },
        }, */
        3: {
          // April
          1: { type: "hijri", text: "Syawal 1447 H" },
          2: { type: "hijri", text: "Syawal 1447 H" },
          3: { type: "hijri", text: "Syawal 1447 H" },
          30: { type: "hijri", text: "Dzulqa'dah 1447 H" },
        },
        4: {
          // Mei
          1: { type: "hijri", text: "Dzulqa'dah 1447 H" },
          2: { type: "hijri", text: "Dzulqa'dah 1447 H" },
        },
        5: {
          // Juni
          28: { type: "hijri", text: "Muharram 1448 H" },
          29: { type: "hijri", text: "Muharram 1448 H" },
          30: { type: "hijri", text: "Muharram 1448 H" },
        },
        6: {
          // Juli
          28: { type: "hijri", text: "Safar 1448 H" },
          29: { type: "hijri", text: "Safar 1448 H" },
          30: { type: "hijri", text: "Safar 1448 H" },
        },
        7: {
          // Agustus
          26: { type: "hijri", text: "Rabi'ul Awal 1448 H" },
          27: { type: "hijri", text: "Rabi'ul Awal 1448 H" },
          28: { type: "hijri", text: "Rabi'ul Awal 1448 H" },
        },
        8: {
          // September
          24: { type: "hijri", text: "Rabi'ul Akhir 1448 H" },
          25: { type: "hijri", text: "Rabi'ul Akhir 1448 H" },
          26: { type: "hijri", text: "Rabi'ul Akhir 1448 H" },
        },
        9: {
          // Oktober
          24: { type: "hijri", text: "Jumadil Ula 1448 H" },
          25: { type: "hijri", text: "Jumadil Ula 1448 H" },
          26: { type: "hijri", text: "Jumadil Ula 1448 H" },
        },
        10: {
          // November
          23: { type: "hijri", text: "Jumadil Akhir 1448 H" },
          24: { type: "hijri", text: "Jumadil Akhir 1448 H" },
          25: { type: "hijri", text: "Jumadil Akhir 1448 H" },
        },
        11: {
          // Desember
          22: { type: "hijri", text: "Rajab 1448 H" },
          23: { type: "hijri", text: "Rajab 1448 H" },
          24: { type: "hijri", text: "Rajab 1448 H" },
        },
      };

      function getDaysInMonth(month, year) {
        return new Date(year, month + 1, 0).getDate();
      }

      function getFirstDayOfMonth(month, year) {
        return new Date(year, month, 1).getDay();
      }

      function renderCalendar(config) {
        const calendarGrid = document.getElementById("calendar-grid");
        const fontSize = config.font_size || defaultConfig.font_size;
        const customFont = config.font_family || defaultConfig.font_family;
        const backgroundColor =
          config.background_color || defaultConfig.background_color;
        const cardColor = config.card_color || defaultConfig.card_color;
        const textColor = config.text_color || defaultConfig.text_color;
        const headerColor = config.header_color || defaultConfig.header_color;
        const accentColor = config.accent_color || defaultConfig.accent_color;

        document.getElementById(
          "calendar-title"
        ).style.fontFamily = `${customFont}, system-ui, sans-serif`;
        document.getElementById("calendar-title").style.fontSize = `${
          fontSize * 2.5
        }px`;
        document.getElementById("calendar-title").style.color = "#ffffff";
        document.getElementById("calendar-title").style.textShadow =
          "2px 2px 4px rgba(0, 0, 0, 0.3)";
        document.getElementById(
          "year-text"
        ).style.fontFamily = `${customFont}, system-ui, sans-serif`;
        document.getElementById("year-text").style.fontSize = `${
          fontSize * 1.25
        }px`;
        document.getElementById("year-text").style.color = "#ffffff";
        document.getElementById("year-text").style.textShadow =
          "1px 1px 3px rgba(0, 0, 0, 0.3)";

        calendarGrid.innerHTML = "";

        for (let month = 0; month < 12; month++) {
          const monthCard = document.createElement("div");
          monthCard.className = "month-card rounded-lg p-1";
          monthCard.style.minHeight = "380px";

          const cardInner = document.createElement("div");
          cardInner.className = "card-inner p-4 rounded-lg";
          cardInner.style.backgroundColor = cardColor;
          cardInner.style.height = "100%";
          cardInner.style.display = "flex";
          cardInner.style.flexDirection = "column";

          const monthHeader = document.createElement("div");
          monthHeader.className = "text-center mb-3 pb-2 border-b-2";
          monthHeader.style.borderColor = headerColor;

          const monthTitle = document.createElement("h2");
          monthTitle.className = "text-xl font-bold";
          monthTitle.textContent = monthNames[month];
          monthTitle.style.fontFamily = `${customFont}, system-ui, sans-serif`;
          monthTitle.style.fontSize = `${fontSize * 1.25}px`;
          monthTitle.style.color = headerColor;
          monthHeader.appendChild(monthTitle);

          const daysHeader = document.createElement("div");
          daysHeader.className = "grid grid-cols-7 gap-1 mb-2";

          dayNames.forEach((day, index) => {
            const dayHeader = document.createElement("div");
            dayHeader.className = "text-center font-semibold py-1";
            dayHeader.textContent = day;
            dayHeader.style.fontFamily = `${customFont}, system-ui, sans-serif`;
            dayHeader.style.fontSize = `${fontSize * 0.75}px`;
            dayHeader.style.color = index === 0 ? "#ef4444" : textColor;
            daysHeader.appendChild(dayHeader);
          });

          const daysGrid = document.createElement("div");
          daysGrid.className = "grid grid-cols-7 gap-1 mb-3";
          daysGrid.style.minHeight = "200px";

          const firstDay = getFirstDayOfMonth(month, 2026);
          const daysInMonth = getDaysInMonth(month, 2026);

          for (let i = 0; i < firstDay; i++) {
            const emptyCell = document.createElement("div");
            emptyCell.className = "text-center py-2";
            emptyCell.style.height = "32px";
            daysGrid.appendChild(emptyCell);
          }

          for (let day = 1; day <= daysInMonth; day++) {
            const dayCell = document.createElement("div");
            dayCell.className =
              "day-cell text-center py-2 rounded cursor-pointer";
            dayCell.style.position = "relative";
            dayCell.style.height = "32px";
            dayCell.textContent = day;
            dayCell.style.fontFamily = `${customFont}, system-ui, sans-serif`;
            dayCell.style.fontSize = `${fontSize * 0.875}px`;

            const dayOfWeek = (firstDay + day - 1) % 7;
            const isHoliday = holidays[month] && holidays[month][day];
            const isHijri = hijriDates[month] && hijriDates[month][day];

            if (isHoliday) {
              if (isHoliday.type === "libur") {
                dayCell.style.backgroundColor = "#fee2e2";
                dayCell.style.color = "#dc2626";
                dayCell.style.fontWeight = "bold";
              } else if (isHoliday.type === "cuti") {
                dayCell.style.backgroundColor = "#fef3c7";
                dayCell.style.color = "#d97706";
                dayCell.style.fontWeight = "bold";
              }
            } else if (dayOfWeek === 0) {
              dayCell.style.color = "#ef4444";
            } else {
              dayCell.style.color = textColor;
            }

            // Tambahkan indikator hijau untuk tanggal hijriah
            if (isHijri) {
              const indicator = document.createElement("div");
              indicator.className = "hijri-indicator";
              dayCell.appendChild(indicator);
            }

            // Tambahkan event listener untuk menampilkan tooltip untuk semua tanggal spesial
            if (isHijri || isHoliday) {
              dayCell.addEventListener("click", function (e) {
                const tooltip = document.getElementById("hijri-tooltip");
                let tooltipText = "";
                let tooltipColor = "rgba(16, 185, 129, 0.95)";

                // Gabungkan semua keterangan jika ada bentrok
                if (isHijri && isHoliday) {
                  tooltipText =
                    isHijri.text + " - Puasa Ayyamul Bidh\n" + isHoliday.text;
                  // Prioritas warna: libur > cuti > hijri
                  if (isHoliday.type === "libur") {
                    tooltipColor = "rgba(220, 38, 38, 0.95)";
                  } else if (isHoliday.type === "cuti") {
                    tooltipColor = "rgba(217, 119, 6, 0.95)";
                  }
                } else if (isHijri) {
                  tooltipText = isHijri.text + " - Puasa Ayyamul Bidh";
                  tooltipColor = "rgba(16, 185, 129, 0.95)";
                } else if (isHoliday) {
                  tooltipText = isHoliday.text;
                  if (isHoliday.type === "libur") {
                    tooltipColor = "rgba(220, 38, 38, 0.95)";
                  } else if (isHoliday.type === "cuti") {
                    tooltipColor = "rgba(217, 119, 6, 0.95)";
                  }
                }

                tooltip.textContent = tooltipText;
                tooltip.style.display = "block";
                tooltip.style.left = e.clientX + 10 + "px";
                tooltip.style.top = e.clientY + 10 + "px";
                tooltip.style.backgroundColor = tooltipColor;
                tooltip.style.whiteSpace = "pre-line";

                // Sembunyikan tooltip setelah 3 detik
                setTimeout(() => {
                  tooltip.style.display = "none";
                }, 3000);
              });
            }

            dayCell.addEventListener("mouseenter", function () {
              this.style.backgroundColor = accentColor;
              this.style.color = "#ffffff";
            });

            dayCell.addEventListener("mouseleave", function () {
              if (isHoliday) {
                if (isHoliday.type === "libur") {
                  this.style.backgroundColor = "#fee2e2";
                  this.style.color = "#dc2626";
                } else if (isHoliday.type === "cuti") {
                  this.style.backgroundColor = "#fef3c7";
                  this.style.color = "#d97706";
                }
              } else {
                this.style.backgroundColor = "transparent";
                if (dayOfWeek === 0) {
                  this.style.color = "#ef4444";
                } else {
                  this.style.color = textColor;
                }
              }
            });

            daysGrid.appendChild(dayCell);
          }

          // Tambahkan sel kosong untuk melengkapi grid agar rapi
          const totalCells = firstDay + daysInMonth;
          const remainingCells = 7 - (totalCells % 7);
          if (remainingCells < 7) {
            for (let i = 0; i < remainingCells; i++) {
              const emptyCell = document.createElement("div");
              emptyCell.className = "text-center py-2";
              emptyCell.style.height = "32px";
              daysGrid.appendChild(emptyCell);
            }
          }

          // Tambahkan keterangan di bawah kalender
          const legendContainer = document.createElement("div");
          legendContainer.className = "mt-auto pt-3 border-t";
          legendContainer.style.borderColor = "#e5e7eb";

          // Kumpulkan semua event untuk bulan ini
          const monthEvents = [];

          // Cek hari libur dan cuti
          if (holidays[month]) {
            Object.keys(holidays[month]).forEach((day) => {
              const event = holidays[month][day];
              monthEvents.push({
                day: parseInt(day),
                text: event.text,
                type: event.type,
              });
            });
          }

          // Cek tanggal hijriah
          if (hijriDates[month]) {
            Object.keys(hijriDates[month]).forEach((day) => {
              const event = hijriDates[month][day];
              const existingEvent = monthEvents.find(
                (e) => e.day === parseInt(day)
              );
              if (existingEvent) {
                // Gabungkan dengan event yang sudah ada
                existingEvent.text =
                  event.text + " - Puasa Ayyamul Bidh / " + existingEvent.text;
                existingEvent.hasHijri = true;
              } else {
                monthEvents.push({
                  day: parseInt(day),
                  text: event.text + " - Puasa Ayyamul Bidh",
                  type: "hijri",
                });
              }
            });
          }

          // Sort events by day
          monthEvents.sort((a, b) => a.day - b.day);

          if (monthEvents.length > 0) {
            monthEvents.forEach((event) => {
              const eventItem = document.createElement("div");
              eventItem.className = "text-xs mb-1";
              eventItem.style.fontFamily = `${customFont}, system-ui, sans-serif`;
              eventItem.style.fontSize = `${fontSize * 0.75}px`;

              const daySpan = document.createElement("span");
              daySpan.style.fontWeight = "bold";
              daySpan.style.marginRight = "4px";
              daySpan.textContent = event.day + ":";

              const textSpan = document.createElement("span");
              textSpan.textContent = event.text;

              if (event.type === "libur" || event.hasHijri) {
                daySpan.style.color = "#dc2626";
                textSpan.style.color = "#dc2626";
              } else if (event.type === "cuti") {
                daySpan.style.color = "#d97706";
                textSpan.style.color = "#d97706";
              } else if (event.type === "hijri") {
                daySpan.style.color = "#10b981";
                textSpan.style.color = "#10b981";
              }

              eventItem.appendChild(daySpan);
              eventItem.appendChild(textSpan);
              legendContainer.appendChild(eventItem);
            });
          } else {
            const noEvents = document.createElement("div");
            noEvents.className = "text-xs text-gray-400 italic";
            noEvents.style.fontFamily = `${customFont}, system-ui, sans-serif`;
            noEvents.style.fontSize = `${fontSize * 0.75}px`;
            noEvents.textContent = "Tidak ada hari khusus";
            legendContainer.appendChild(noEvents);
          }

          cardInner.appendChild(monthHeader);
          cardInner.appendChild(daysHeader);
          cardInner.appendChild(daysGrid);
          cardInner.appendChild(legendContainer);

          monthCard.appendChild(cardInner);
          calendarGrid.appendChild(monthCard);
        }
      }

      async function onConfigChange(config) {
        document.getElementById("calendar-title").textContent =
          config.calendar_title || defaultConfig.calendar_title;
        document.getElementById("year-text").textContent =
          config.year_text || defaultConfig.year_text;
        renderCalendar(config);
      }

      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () =>
                  config.background_color || defaultConfig.background_color,
                set: (value) => {
                  config.background_color = value;
                  window.elementSdk.setConfig({ background_color: value });
                },
              },
              {
                get: () => config.card_color || defaultConfig.card_color,
                set: (value) => {
                  config.card_color = value;
                  window.elementSdk.setConfig({ card_color: value });
                },
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => {
                  config.text_color = value;
                  window.elementSdk.setConfig({ text_color: value });
                },
              },
              {
                get: () => config.header_color || defaultConfig.header_color,
                set: (value) => {
                  config.header_color = value;
                  window.elementSdk.setConfig({ header_color: value });
                },
              },
              {
                get: () => config.accent_color || defaultConfig.accent_color,
                set: (value) => {
                  config.accent_color = value;
                  window.elementSdk.setConfig({ accent_color: value });
                },
              },
            ],
            borderables: [],
            fontEditable: {
              get: () => config.font_family || defaultConfig.font_family,
              set: (value) => {
                config.font_family = value;
                window.elementSdk.setConfig({ font_family: value });
              },
            },
            fontSizeable: {
              get: () => config.font_size || defaultConfig.font_size,
              set: (value) => {
                config.font_size = value;
                window.elementSdk.setConfig({ font_size: value });
              },
            },
          }),
          mapToEditPanelValues: (config) =>
            new Map([
              [
                "calendar_title",
                config.calendar_title || defaultConfig.calendar_title,
              ],
              ["year_text", config.year_text || defaultConfig.year_text],
            ]),
        });
      }

      renderCalendar(defaultConfig);
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'9b269bb5511dfd7d',t:'MTc2NjQ3OTc5My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
  </body>
</html>
